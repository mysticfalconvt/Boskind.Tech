<script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js">
    </script>
    <script>

   var userEmail = google.script.run.withSuccessHandler().getUserEmail();
              
       document.addEventListener("DOMContentLoaded",function(){
        
         google.script.run.withSuccessHandler(generateTable).getTableData();
         google.script.run.withSuccessHandler(populateNames).getStudentList();
             
      });
      //Listener for select from list

      
      // click to search student name
      document.getElementById("searchStudent").addEventListener("click", function(){
        var studentName = document.getElementById("studentName").value;
      
        google.script.run.withSuccessHandler(generateTable).withUserObject(studentName).getTableData();
        
      });
      
      //populate names for autocomplete
      function populateNames(names){
        var elems = document.getElementById('studentName');
        var instances = M.Autocomplete.init(elems, {data: names});
        
       };
      
      
      function generateTable(dataArray,studentName){
        if(studentName){
     var filterlogic = function(item){
            if(String(item[0].toLowerCase()).indexOf(studentName.toLowerCase()) > -1) {
              return true;
            }
            else {
              return false;
            }
            };
    
    
    var sorted = dataArray.filter(filterlogic);
    } else{
      var sorted = dataArray;
      };
      
      
           var tbody = document.getElementById("table-body");
          tbody.innerHTML = "";
        sorted.forEach(function(r){
//            if(r[0] == userEmail){
            
         var row = document.createElement("tr");
          var col1 = document.createElement("td");
          col1.textContent = r[0];
          var col2 = document.createElement("td");
          col2.textContent = r[1];
          var col3 = document.createElement("td");
          col3.textContent = r[2];
          var col4 = document.createElement("td");
          col4.textContent = r[3];
          var col5 = document.createElement("td");
          col5.textContent = r[4];
          var col6 = document.createElement("td");
          col6.textContent = r[5];
          row.appendChild(col1);
          row.appendChild(col2);
          row.appendChild(col3);
          row.appendChild(col4);
          row.appendChild(col5);
          row.appendChild(col6);
          tbody.appendChild(row);
//          }
        
        });
      
     };
     

     
           function generateSchedule(dataArray){
          
            
      
           var tbody = document.getElementById("Schedule");
      
        dataArray.forEach(function(r){
//            if(r[0] == userEmail){
            
          var row = document.createElement("tr");
          var col1 = document.createElement("td");
          col1.textContent = r[0];
          var col2 = document.createElement("td");
          col2.textContent = r[1];
          var col3 = document.createElement("td");
          col3.textContent = r[2];
          var col4 = document.createElement("td");
          col4.textContent = r[3];
          var col5 = document.createElement("td");
          col5.textContent = r[4];
          var col6 = document.createElement("td");
          col6.textContent = r[5];
          row.appendChild(col1);
          row.appendChild(col2);
          row.appendChild(col3);
          row.appendChild(col4);
          row.appendChild(col5);
          row.appendChild(col6);
          tbody.appendChild(row);
//          }
        
        });
      };


// Get the input field
var input = document.getElementById("studentName");

// Execute a function when the user releases a key on the keyboard
input.addEventListener("keyup", function(e) {
  // Number 13 is the "Enter" key on the keyboard
  if (e.keyCode === 13) {
    // Cancel the default action, if needed
  //  event.preventDefault();
    // Trigger the button element with a click
    document.getElementById("searchStudent").click();
  }
});

    </script>

